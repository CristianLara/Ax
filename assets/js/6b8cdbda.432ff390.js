"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1227],{94221:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>o});var n=a(74848),r=a(28453);const i={id:"data",title:"Data"},d=void 0,c={id:"data",title:"Data",description:"Fetching Data",source:"@site/versioned_docs/version-0.9.1/data.md",sourceDirName:".",slug:"/data",permalink:"/Ax/docs/0.9.1/data",draft:!1,unlisted:!1,tags:[],version:"0.9.1",lastUpdatedBy:"Cristian Lara",lastUpdatedAt:1731960051e3,frontMatter:{id:"data",title:"Data"},sidebar:"docs",previous:{title:"Trial Evaluation",permalink:"/Ax/docs/0.9.1/trial-evaluation"},next:{title:"Models",permalink:"/Ax/docs/0.9.1/models"}},s={},o=[{value:"Fetching Data",id:"fetching-data",level:2},{value:"Adding Your Own Metric",id:"adding-your-own-metric",level:2},{value:"Advanced Data Fetching",id:"advanced-data-fetching",level:2}];function l(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"fetching-data",children:"Fetching Data"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"/Ax/docs/0.9.1/glossary#metric",children:"Metrics"})," provide an interface for fetching data for an experiment or trial. Experiment objectives and outcome constraints are special types of metrics, and you can also attach additional metrics for tracking purposes."]}),"\n",(0,n.jsxs)(t.p,{children:["Each metric is responsible for fetching its own data. Thus, all metric classes must implement the method ",(0,n.jsx)(t.code,{children:"fetch_trial_data"}),", which accepts a ",(0,n.jsx)(t.a,{href:"../api/core.html#ax.core.trial.Trial",children:(0,n.jsx)(t.code,{children:"Trial"})})," and returns an instance of ",(0,n.jsx)(t.a,{href:"../api/core.html#ax.core.data.Data",children:(0,n.jsx)(t.code,{children:"Data"})}),", a wrapper around a Pandas DataFrame."]}),"\n",(0,n.jsxs)(t.p,{children:["To fetch data for an experiment or trial, use ",(0,n.jsx)(t.code,{children:"exp.fetch_data"})," or ",(0,n.jsx)(t.code,{children:"trial.fetch_data"}),". These methods fetch data for all metrics on the experiment and then combine the results into a new aggregate ",(0,n.jsx)(t.a,{href:"../api/core.html#ax.core.data.Data",children:(0,n.jsx)(t.code,{children:"Data"})})," instance."]}),"\n",(0,n.jsxs)(t.p,{children:["Each row of the final DataFrame represents the evaluation of an arm on a metric. As such, the required columns are: ",(0,n.jsx)(t.code,{children:"arm_name"}),", ",(0,n.jsx)(t.code,{children:"metric_name"}),", ",(0,n.jsx)(t.code,{children:"mean"}),", and ",(0,n.jsx)(t.code,{children:"sem"}),". Additional optional columns are also supported: ",(0,n.jsx)(t.code,{children:"trial_index"}),", ",(0,n.jsx)(t.code,{children:"start_time"}),", and ",(0,n.jsx)(t.code,{children:"end_time"}),"."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"arm_name"}),(0,n.jsx)(t.th,{children:"metric_name"}),(0,n.jsx)(t.th,{children:"mean"}),(0,n.jsx)(t.th,{children:"sem"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"0_0"}),(0,n.jsx)(t.td,{children:"metric1"}),(0,n.jsx)(t.td,{children:"..."}),(0,n.jsx)(t.td,{children:"..."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"0_0"}),(0,n.jsx)(t.td,{children:"metric2"}),(0,n.jsx)(t.td,{children:"..."}),(0,n.jsx)(t.td,{children:"..."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"0_1"}),(0,n.jsx)(t.td,{children:"metric1"}),(0,n.jsx)(t.td,{children:"..."}),(0,n.jsx)(t.td,{children:"..."})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"0_1"}),(0,n.jsx)(t.td,{children:"metric2"}),(0,n.jsx)(t.td,{children:"..."}),(0,n.jsx)(t.td,{children:"..."})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"adding-your-own-metric",children:"Adding Your Own Metric"}),"\n",(0,n.jsxs)(t.p,{children:["Our base Metric class is meant to be subclassed. Subclasses must provide an implementation of ",(0,n.jsx)(t.code,{children:"fetch_trial_data"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"An example of a custom metric:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:'import pandas as pd\nfrom ax import Metric\n\nclass CustomMetric(Metric):\n\n    def fetch_trial_data(self, trial, **kwargs):\n        records = []\n        for arm_name, arm in trial.arms_by_name.items():\n            records.append({\n                "arm_name": arm_name,\n                "metric_name": self.name,\n                "mean": 0.0,  # mean value of this metric when this arm is used\n                "sem": 0.0,  # standard error of the above mean\n                "trial_index": trial.index,\n            })\n        return Data(df=pd.DataFrame.from_records(records))\n'})}),"\n",(0,n.jsx)(t.h2,{id:"advanced-data-fetching",children:"Advanced Data Fetching"}),"\n",(0,n.jsxs)(t.p,{children:["If you need to fetch data for multiple metrics or trials simultaneously,\nyour Metric can implement the methods ",(0,n.jsx)(t.code,{children:"fetch_experiment_data"}),", ",(0,n.jsx)(t.code,{children:"fetch_trial_data_multi"}),",\nand ",(0,n.jsx)(t.code,{children:"fetch_experiment_data_multi"}),". The default implementations of these methods\nuse ",(0,n.jsx)(t.code,{children:"fetch_trial_data"})," internally, but can be overridden if bulk data fetching\nis more appropriate for the metric type."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,a)=>{a.d(t,{R:()=>d,x:()=>c});var n=a(96540);const r={},i=n.createContext(r);function d(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);
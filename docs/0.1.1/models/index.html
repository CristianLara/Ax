<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-0.1.1 docs-doc-page docs-doc-id-models" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Models | Ax</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="http://cristianlara.me/Ax/img/ax.svg"><meta data-rh="true" name="twitter:image" content="http://cristianlara.me/Ax/img/ax.svg"><meta data-rh="true" property="og:url" content="http://cristianlara.me/Ax/docs/0.1.1/models"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="0.1.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-0.1.1"><meta data-rh="true" name="docsearch:version" content="0.1.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-0.1.1"><meta data-rh="true" property="og:title" content="Models | Ax"><meta data-rh="true" name="description" content="Using models in Ax"><meta data-rh="true" property="og:description" content="Using models in Ax"><link data-rh="true" rel="icon" href="/Ax/img/favicon.png"><link data-rh="true" rel="canonical" href="http://cristianlara.me/Ax/docs/0.1.1/models"><link data-rh="true" rel="alternate" href="http://cristianlara.me/Ax/docs/0.1.1/models" hreflang="en"><link data-rh="true" rel="alternate" href="http://cristianlara.me/Ax/docs/0.1.1/models" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://8X3RTPIIL1-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/Ax/blog/rss.xml" title="Ax RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Ax/blog/atom.xml" title="Ax Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Ax" href="/Ax/opensearch.xml">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="/Ax/js/plotUtils.js"></script>
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.2.min.js"></script>
<script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.2.min.js"></script><link rel="stylesheet" href="/Ax/assets/css/styles.ea52e071.css">
<script src="/Ax/assets/js/runtime~main.151ac624.js" defer="defer"></script>
<script src="/Ax/assets/js/main.87567f47.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Ax/"><div class="navbar__logo"><img src="/Ax/img/ax.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Ax/img/ax.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ax</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Ax/docs/0.1.1/why-ax">Docs</a><a class="navbar__item navbar__link" href="/Ax/docs/0.1.1/tutorials/">Tutorials</a><a href="https://ax.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/Ax/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/Ax/docs/0.1.1/models">0.1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Ax/docs/next/models">Next</a></li><li><a class="dropdown__link" href="/Ax/docs/models">0.9.5</a></li><li><a class="dropdown__link" href="/Ax/docs/0.9.4/models">0.9.4</a></li><li><a class="dropdown__link" href="/Ax/docs/0.9.3/models">0.9.3</a></li><li><a class="dropdown__link" href="/Ax/docs/0.9.2/models">0.9.2</a></li><li><a class="dropdown__link" href="/Ax/docs/0.9.1/models">0.9.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/Ax/docs/0.1.1/models">0.1.1</a></li><li><a class="dropdown__link" href="/Ax/docs/0.1.0/models">0.1.0</a></li><li><hr class="margin-vert--sm"></li><li class="margin-horiz--sm text--bold"><small>Archived versions<small></small></small></li><li><a href="https://ax.dev" target="_blank" rel="noopener noreferrer" class="dropdown__link">0.x.x<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/cristianlara/Ax" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/Ax/"><img src="/Ax/img/ax.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Ax/img/ax.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>Ax</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Ax/docs/0.1.1/why-ax">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Ax/docs/0.1.1/installation">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Ax/docs/0.1.1/bayesopt">Algorithms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/Ax/docs/0.1.1/core">Components</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Ax/docs/0.1.1/core">Core</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Ax/docs/0.1.1/trial-evaluation">Trial Evaluation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Ax/docs/0.1.1/data">Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Ax/docs/0.1.1/models">Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Ax/docs/0.1.1/storage">Storage</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Ax<!-- --> <b>0.1.1</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/Ax/docs/models">latest version</a></b> (<!-- -->0.9.5<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Ax/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Components</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Models</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 0.1.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Models</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-models-in-ax">Using models in Ax<a href="#using-models-in-ax" class="hash-link" aria-label="Direct link to Using models in Ax" title="Direct link to Using models in Ax">​</a></h2>
<p>In the optimization algorithms implemented by Ax, models predict the outcomes of metrics within an experiment evaluated at a parameterization, and are used to predict metrics or suggest new parameterizations for trials. Models in Ax are created using factory functions from the <a href="/Ax/docs/api/modelbridge.html#module-ax.modelbridge.factory"><code>ax.modelbridge.factory</code></a>. All of these models share a common API with <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict()</code></a> to make predictions at new points and <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.gen"><code>gen()</code></a> to generate new candidates to be tested. There are a variety of models available in the factory; here we describe the usage patterns for the primary model types and show how the various Ax utilities can be used with models.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sobol-sequence">Sobol sequence<a href="#sobol-sequence" class="hash-link" aria-label="Direct link to Sobol sequence" title="Direct link to Sobol sequence">​</a></h4>
<p>The <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.factory.get_sobol"><code>get_sobol</code></a> function is used to construct a model that produces a quasirandom Sobol sequence when<a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.gen"><code>gen</code></a> is called. This code generates a scrambled Sobol sequence of 10 points:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modelbridge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factory </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_sobol</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_sobol</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">search_space</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output of <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.gen"><code>gen</code></a> is a <a href="/Ax/docs/api/core.html#ax.core.generator_run.GeneratorRun"><code>GeneratorRun</code></a> object that contains the generated points, along with metadata about the generation process. The generated arms can be accessed at <a href="/Ax/docs/api/core.html#ax.core.generator_run.GeneratorRun.arms"><code>GeneratorRun.arms</code></a>.</p>
<p>Additional arguments can be passed to <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.factory.get_sobol"><code>get_sobol</code></a> such as <code>scramble=False</code> to disable scrambling, and <code>seed</code> to set a seed (see <a href="/Ax/docs/api/models.html#ax.models.random.sobol.SobolGenerator">model API</a>).</p>
<p>Sobol sequences are typically used to select initialization points, and this model does not implement <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict</code></a>. It can be used on search spaces with any combination of discrete and continuous parameters.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="gaussian-process-with-ei">Gaussian Process with EI<a href="#gaussian-process-with-ei" class="hash-link" aria-label="Direct link to Gaussian Process with EI" title="Direct link to Gaussian Process with EI">​</a></h4>
<p>Gaussian Processes (GPs) are used for <a href="/Ax/docs/0.1.1/bayesopt">Bayesian Optimization</a> in Ax, the <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.factory.get_gpei"><code>get_GPEI</code></a> function constructs a model that fits a GP to the data, and uses the EI acquisition function to generate new points on calls to <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.gen"><code>gen</code></a>. This code fits a GP and generates a batch of 5 points which maximizes EI:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modelbridge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factory </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_GPEI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_GPEI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimization_config</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">optimization_config</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In contrast to <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.factory.get_sobol"><code>get_sobol</code></a>, the GP requires data and is able to make predictions. We make predictions by constructing a list of <a href="/Ax/docs/api/core.html#ax.core.observation.ObservationFeatures"><code>ObservationFeatures</code></a> objects with the parameter values for which we want predictions:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">observation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ObservationFeatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obs_feats </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObservationFeatures</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameters</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;x1&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;x2&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.72</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObservationFeatures</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameters</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;x1&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.41</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;x2&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.62</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cov </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">obs_feats</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output of <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict</code></a> is the mean estimate of each metric and the covariance (across metrics) for each point.</p>
<p>All Ax models that implement <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict</code></a> can be used with the built-in plotting utilities, which can produce plots of model predictions on 1-d or 2-d slices of the parameter space:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">slice</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> plot_slice</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">notebook</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plotting </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> render</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> init_notebook_plotting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">init_notebook_plotting</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plot_slice</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    param_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;x1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># slice on values of &#x27;x1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metric_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;metric_a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    slice_values</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;x2&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7.5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Fix at this value for the slice</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div id="slice" style="width:100%"></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">contour </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> plot_contour</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plot_contour</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    param_x</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;x1&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    param_y</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;x2&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    metric_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;metric_a&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div id="contour" style="width:100%"></div>
<p>Ax also includes utilities for cross validation to assess model predictive performance. Leave-one-out cross validation can be performed as follows:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modelbridge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cross_validation </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cross_validate</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> compute_diagnostics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cross_validate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diagnostics </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> compute_diagnostics</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.cross_validation.compute_diagnostics"><code>compute_diagnostics</code></a> computes a collection of diagnostics of model predictions, such as the correlation between predictions and actual values, and the p-value for a Fisher test of the model&#x27;s ability to distinguish high values from low. A very useful tool for assessing model performance is to plot the cross validated predictions against the actual observed values:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">diagnostic </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> interact_cross_validation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">interact_cross_validation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div id="cv" style="width:100%"></div>
<p>If the model fits the data well, the values will lie along the diagonal. Poor GP fits tend to produce cross validation plots that are flat with high predictive uncertainty - such fits are unlikely to produce good candidates in <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.gen"><code>gen</code></a>.</p>
<p>By default, this model will apply a number of transformations to the feature space, such as one-hot encoding of <a href="/Ax/docs/api/core.html#ax.core.parameter.ChoiceParameter"><code>ChoiceParameters</code></a> and log transformation of <a href="/Ax/docs/api/core.html#ax.core.parameter.RangeParameter"><code>RangeParameters</code></a> which have <code>log_scale</code> set to <code>True</code>. Transforms are also applied to the observed outcomes, such as standardizing the data for each metric. See <a href="/Ax/docs/0.1.1/models#Transforms">the section below on Transforms</a> for a description of the default transforms, and how new transforms can be implemented and included.</p>
<p>GPs typically does a good job of modeling continuous parameters (<a href="/Ax/docs/api/core.html#ax.core.parameter.RangeParameter"><code>RangeParameters</code></a>). If the search space contains <a href="/Ax/docs/api/core.html#ax.core.parameter.ChoiceParameter"><code>ChoiceParameters</code></a>, they will be one-hot-encoded and the GP fit in the encoded space. A search space with a mix of continuous parameters and <a href="/Ax/docs/api/core.html#ax.core.parameter.ChoiceParameter"><code>ChoiceParameters</code></a> that take a small number of values can be modeled effectively with a GP, but model performance may be poor if there are more than about 20 parameters after one-hot encoding. Cross validation is an effective tool for determining usefulness of the GP on a particular problem.</p>
<p>In discrete spaces where the GP does not predict well, a multi-armed bandit approach is often preferred, and we now discuss the models suitable for that approach.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="support-for-mixed-search-spaces-and-categorical-variables">Support for mixed search spaces and categorical variables<a href="#support-for-mixed-search-spaces-and-categorical-variables" class="hash-link" aria-label="Direct link to Support for mixed search spaces and categorical variables" title="Direct link to Support for mixed search spaces and categorical variables">​</a></h4>
<p>The most common way of dealing with categorical variables in Bayesian optimization is to one-hot encode the categories to allow fitting a GP model in a continuous space. In this setting, a categorical variable with categories <code>[&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;]</code> is represented by three new variables (one for each category). While this is a convenient choice, it can drastically increase the dimensionality of the search space. In addition, the acquisition function is often optimized in the corresponding continuous space and the final candidate is selected by rounding back to the original space, which may result in selecting sub-optimal points according to the acquisition function.</p>
<p>Our new approach uses separate kernels for the categorical and ordinal (continuous/integer) variables. In particular, we use a kernel of the form:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>k</mi><mtext>cat</mtext></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mtext>cat</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>cat</mtext></msub><mo stretchy="false">)</mo><mo>×</mo><msub><mi>k</mi><mtext>ord</mtext></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mtext>ord</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>ord</mtext></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mtext>cat</mtext></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mtext>cat</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>cat</mtext></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>k</mi><mtext>ord</mtext></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mtext>ord</mtext></msub><mo separator="true">,</mo><msub><mi>y</mi><mtext>ord</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k(x, y) = k_\text{cat}(x_\text{cat}, y_\text{cat}) \times k_\text{ord}(x_\text{ord}, y_\text{ord}) + k_\text{cat}(x_\text{cat}, y_\text{cat}) + k_\text{ord}(x_\text{ord}, y_\text{ord})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">cat</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">cat</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">cat</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">cat</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">cat</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">cat</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord text mtight"><span class="mord mtight">ord</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>
<p>For the ordinal variables we can use a standard kernel such as Matérn-5/2, but for the categorical variables we need a way to compute distances between the different categories. A natural choice is to set the distance is 0 if two categories are equal and 1 otherwise, similar to the idea of Hamming distances. This approach can be combined with the idea of automatic relevance determination (ARD) where each categorical variable has its own lengthscale. Rather than optimizing the acquisition function in a continuously relaxed space, we optimize it separately over each combination of the categorical variables. While this is likely to result in better optimization performance, it may lead to slow optimization of the acquisition function when there are many categorical variables.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="empirical-bayes-and-thompson-sampling">Empirical Bayes and Thompson sampling<a href="#empirical-bayes-and-thompson-sampling" class="hash-link" aria-label="Direct link to Empirical Bayes and Thompson sampling" title="Direct link to Empirical Bayes and Thompson sampling">​</a></h4>
<p>For <a href="/Ax/docs/0.1.1/banditopt">Bandit optimization</a>, The <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.factory.get_empirical_bayes_thompson"><code>get_empirical_bayes_thompson</code></a> factory function returns a model that applies <a href="/Ax/docs/0.1.1/banditopt#empirical-bayes">empirical Bayes shrinkage</a> to a discrete set of arms, and then uses Thompson sampling to construct a policy with the weight that should be allocated to each arms. Here we apply empirical Bayes to the data and use Thompson sampling to generate a policy that is truncated at <code>n=10</code> arms:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modelbridge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factory </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_empirical_bayes_thompson</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_empirical_bayes_thompson</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimization_config</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">optimization_config</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The arms and their corresponding weights can be accessed as <code>gr.arm_weights</code>.</p>
<p>As with the GP, we can use <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict</code></a> to evaluate the model at points of our choosing. However, because this is a purely in-sample model, those points should correspond to arms that were in the data. The model prediction will return the estimate at that point after applying the empirical Bayes shrinkage:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cov </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ObservationFeatures</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parameters</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&#x27;x1&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;x2&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.72</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can generate a plot that shows the predictions for each arm with the shrinkage using <a href="/Ax/docs/api/plot.html#ax.plot.scatter.plot_fitted"><code>plot_fitted</code></a>, which shows model predictions on all in-sample arms:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scatter </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> plot_fitted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plot_fitted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> metric</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;metric_a&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rel</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div id="fitted" style="width:100%"></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="factorial-designs">Factorial designs<a href="#factorial-designs" class="hash-link" aria-label="Direct link to Factorial designs" title="Direct link to Factorial designs">​</a></h4>
<p>The factory function <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.factory.get_factorial"><code>get_factorial</code></a> can be used to construct a factorial design on a set of <a href="/Ax/docs/api/core.html#ax.core.parameter.ChoiceParameter"><code>ChoiceParameters</code></a>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> ax</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modelbridge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">factory </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> get_factorial</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_factorial</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">search_space</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> m</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Like the Sobol sequence, the factorial model is only used to generate points and does not implement <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict</code></a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deeper-dive-organization-of-the-modeling-stack">Deeper dive: organization of the modeling stack<a href="#deeper-dive-organization-of-the-modeling-stack" class="hash-link" aria-label="Direct link to Deeper dive: organization of the modeling stack" title="Direct link to Deeper dive: organization of the modeling stack">​</a></h2>
<p>Ax uses a bridge design to provide a unified interface for models, while still allowing for modularity in how different types of models are implemented. The modeling stack consists of two layers: the <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> and the Model.</p>
<p>The <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> is the object that is directly used in Ax: model factories return <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> objects, and plotting and cross validation tools operate on a <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a>. The <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> defines a unified API for all of the models used in Ax via methods like <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.predict"><code>predict</code></a> and <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge.gen"><code>gen</code></a>. Internally, it is responsible for transforming Ax objects like <a href="/Ax/docs/api/core.html#ax.core.arm.Arm"><code>Arm</code></a> and <a href="/Ax/docs/api/core.html#ax.core.data.Data"><code>Data</code></a> into objects which are then consumed downstream by a Model.</p>
<p>Model objects are only used in Ax via a <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a>. Each Model object defines an API which does not use Ax objects, allowing for modularity of different model types and making it easy to implement new models. For example, the TorchModel defines an API for a model that operates on torch tensors. There is a 1-to-1 link between <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> objects and Model objects. For instance, the TorchModelBridge takes in Ax objects, converts them to torch tensors, and sends them along to the TorchModel. Similar pairings exist for all of the different model types:</p>
<table><thead><tr><th>ModelBridge</th><th>Model</th><th>Example implementation</th><th></th></tr></thead><tbody><tr><td><a href="/Ax/docs/api/modelbridge.html#module-ax.modelbridge.torch"><code>TorchModelBridge</code></a></td><td><a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel"><code>TorchModel</code></a></td><td><a href="/Ax/docs/api/models.html#ax.models.torch.botorch.BotorchModel"><code>BotorchModel</code></a></td><td></td></tr><tr><td><a href="/Ax/docs/api/modelbridge.html#module-ax.modelbridge.discrete"><code>DiscreteModelBridge</code></a></td><td><a href="/Ax/docs/api/models.html#ax.models.discrete_base.DiscreteModel"><code>DiscreteModel</code></a></td><td><a href="/Ax/docs/api/models.html#ax.models.discrete.thompson.ThompsonSampler"><code>ThompsonSampler</code></a></td><td></td></tr><tr><td><a href="/Ax/docs/api/modelbridge.html#module-ax.modelbridge.random"><code>RandomModelBridge</code></a></td><td><a href="/Ax/docs/api/models.html#ax.models.random.base.RandomModel"><code>RandomModel</code></a></td><td><a href="/Ax/docs/api/models.html#ax.models.random.sobol.SobolGenerator"><code>SobolGenerator</code></a></td><td></td></tr></tbody></table>
<p>This structure allows for different models like the GP in BotorchModel and the Random Forest in RandomForest to share an interface and use common plotting tools at the level of the ModelBridge, while each is implemented using its own torch or numpy structures.</p>
<p>The primary role of the <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> is to act as a transformation layer. This includes transformations to the data, search space, and optimization config such as standardization and log transforms, as well as the final transform from Ax objects into the objects consumed by the Model. We now describe how transforms are implemented and used in the ModelBridge.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="transforms">Transforms<a href="#transforms" class="hash-link" aria-label="Direct link to Transforms" title="Direct link to Transforms">​</a></h2>
<p>The transformations in the <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> are done by chaining together a set of individual Transform objects. For continuous space models obtained via factory functions (<a href="/Ax/api/data.html#.data.users.adamobeng.fbsource.fbcode.ax.ax.modelbridge.factory.get_sobol"><code>get_sobol</code></a> and <a href="/Ax/api/data.html#.data.users.adamobeng.fbsource.fbcode.ax.ax.modelbridge.factory.get_GPEI"><code>get_GPEI</code></a>), the following transforms will be applied by default, in this sequence:</p>
<ul>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.remove_fixed.RemoveFixed"><code>RemoveFixed</code></a>: Remove <a href="/Ax/docs/api/core.html#ax.core.parameter.FixedParameter"><code>FixedParameters</code></a> from the search space.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.choice_encode.OrderedChoiceEncode"><code>OrderedChoiceEncode</code></a>: <a href="/Ax/docs/api/core.html#ax.core.parameter.ChoiceParameter"><code>ChoiceParameters</code></a> with <code>is_ordered</code> set to <code>True</code> are encoded as a sequence of integers.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.one_hot.OneHot"><code>OneHot</code></a>: <a href="/Ax/docs/api/core.html#ax.core.parameter.ChoiceParameter"><code>ChoiceParameters</code></a> with <code>is_ordered</code> set to <code>False</code> are one-hot encoded.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.int_to_float.IntToFloat"><code>IntToFloat</code></a>: Integer-valued <a href="/Ax/docs/api/core.html#ax.core.parameter.RangeParameter"><code>RangeParameters</code></a> are converted to have float values.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.log.Log"><code>Log</code></a>: <a href="/Ax/docs/api/core.html#ax.core.parameter.RangeParameter"><code>RangeParameters</code></a> with <code>log_scale</code> set to <code>True</code> are log transformed.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.unit_x.UnitX"><code>UnitX</code></a>: All float <a href="/Ax/docs/api/core.html#ax.core.parameter.RangeParameter"><code>RangeParameters</code></a> are mapped to <code>[0, 1]</code>.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.derelativize.Derelativize"><code>Derelativize</code></a>: Constraints relative to status quo are converted to constraints on raw values.</li>
<li><a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.standardize_y.StandardizeY"><code>StandardizeY</code></a>: The Y values for each metric are standardized (subtract mean, divide by standard deviation).</li>
</ul>
<p>Each transform defines both a forward and backwards transform. Arm parameters are passed through the forward transform before being sent along to the Model. The Model works entirely in the transformed space, and when new candidates are generated, they are passed through all of the backwards transforms so the <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> returns points in the original space.</p>
<p>New transforms can be implemented by creating a subclass of <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.base.Transform"><code>Transform</code></a>, which defines the interface for all transforms. There are separate methods for transforming the search space, optimization config, observation features, and observation data. Transforms that operate on only some aspects of the problem do not need to implement all methods, for instance, <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.log.Log"><code>Log</code></a> implements only <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.log.Log.transform_observation_features"><code>transform_observation_features</code></a> (to log transform the parameters), <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.log.Log.transform_search_space"><code>transform_search_space</code></a> (to log transform the search space bounds), and <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.transforms.log.Log.untransform_observation_features"><code>untransform_observation_features</code></a> (to apply the inverse transform).</p>
<p>The (ordered) list of transforms to apply is an input to the ModelBridge, and so can easily be altered to add new transforms. It is important that transforms be applied in the right order. For instance, <code>StandardizeY</code> and <code>Winsorize</code> both transform the observed metric values. Applying them in the order <code>[StandardizeY, Winsorize]</code> could produce very different results than <code>[Winsorize, StandardizeY]</code>. In the former case, outliers would have already been included in the standardization (a procedure sensitive to outliers), and so the second approach that winsorizes first is preferred.</p>
<p>See <a href="/Ax/docs/api/modelbridge.html#transforms">the API reference</a> for the full collection of implemented transforms.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementing-new-models">Implementing new models<a href="#implementing-new-models" class="hash-link" aria-label="Direct link to Implementing new models" title="Direct link to Implementing new models">​</a></h2>
<p>The structure of the modeling stack makes it easy to implement new models and use them inside Ax. There are two ways this might be done.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="using-an-existing-model-interface">Using an existing Model interface<a href="#using-an-existing-model-interface" class="hash-link" aria-label="Direct link to Using an existing Model interface" title="Direct link to Using an existing Model interface">​</a></h3>
<p>The easiest way to implement a new model is if it can be adapted to one of the existing Model interfaces: (<a href="/Ax/docs/0.1.1/api/models.html#ax.models.torch_base.TorchModel"><code>TorchModel</code></a>, <a href="/Ax/docs/api/models.html#ax.models.discrete_base.DiscreteModel"><code>DiscreteModel</code></a>, or <a href="/Ax/docs/api/models.html#ax.models.random.base.RandomModel"><code>RandomModel</code></a>). The class definition provides the interface for each of the methods that should be implemented in order for Ax to be able to fully use the new model. Note however that not all methods must need be implemented to use some Ax functionality. For instance, an implementation of <a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel"><code>TorchModel</code></a> that implements only <a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel.fit"><code>fit</code></a> and <a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel.predict"><code>predict</code></a> can be used to fit data and make plots in Ax; however, it will not be able to generate new candidates (requires implementing <a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel.gen"><code>gen</code></a>) or be used with Ax&#x27;s cross validation utility (requires implementing <a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel.cross_validate"><code>cross_validate</code></a>).</p>
<p>Once the new model has been implemented, it can be used in Ax with the corresponding <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> from the table above. For instance, suppose a new torch-based model was implemented as a subclass of <a href="/Ax/docs/api/models.html#ax.models.torch_base.TorchModel"><code>TorchModel</code></a>. We can use that model in Ax like:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">new_model_obj </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NewModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">init_args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># An instance of the new model class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TorchModelBridge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    experiment</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">experiment</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    search_space</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">search_space</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">new_model_obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    transforms</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">UnitX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StandardizeY</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Include the desired set of transforms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> object <code>m</code> can then be used with plotting and cross validation utilities exactly the same way as the built-in models.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="creating-a-new-model-interface">Creating a new Model interface<a href="#creating-a-new-model-interface" class="hash-link" aria-label="Direct link to Creating a new Model interface" title="Direct link to Creating a new Model interface">​</a></h3>
<p>If none of the existing Model interfaces work are suitable for the new model type, then a new interface will have to be created. This involves two steps: creating the new model interface and creating the new model bridge. The new model bridge must be a subclass of <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> that implements <code>ModelBridge._fit</code>,  <code>ModelBridge._predict</code>, <code>ModelBridge._gen</code>, and  <code>ModelBridge._cross_validate</code>. The implementation of each of these methods will transform the Ax objects in the inputs into objects required for the interface with the new model type. The model bridge will then call out to the new model interface to do the actual modeling work. All of the ModelBridge/Model pairs in the table above provide examples of how this interface can be defined. The main key is that the inputs on the <a href="/Ax/docs/api/modelbridge.html#ax.modelbridge.base.ModelBridge"><code>ModelBridge</code></a> side are fixed, but those inputs can then be transformed in whatever way is desired for the downstream Model interface to be that which is most convenient for implementing the model.</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">assets/slice.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">assets/contour.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">assets/cv.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">text/javascript</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">src</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">assets/fitted.js</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-12-02T22:18:27.000Z" itemprop="dateModified">Dec 2, 2024</time></b> by <b>Cristian Lara</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Ax/docs/0.1.1/data"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Data</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Ax/docs/0.1.1/storage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Storage</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-models-in-ax" class="table-of-contents__link toc-highlight">Using models in Ax</a></li><li><a href="#deeper-dive-organization-of-the-modeling-stack" class="table-of-contents__link toc-highlight">Deeper dive: organization of the modeling stack</a></li><li><a href="#transforms" class="table-of-contents__link toc-highlight">Transforms</a></li><li><a href="#implementing-new-models" class="table-of-contents__link toc-highlight">Implementing new models</a><ul><li><a href="#using-an-existing-model-interface" class="table-of-contents__link toc-highlight">Using an existing Model interface</a></li><li><a href="#creating-a-new-model-interface" class="table-of-contents__link toc-highlight">Creating a new Model interface</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Ax/docs/why-ax">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/cristianlara/ax" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/cristianlara/ax/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/Ax/img/meta_opensource_logo_negative.svg" alt="Ax" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Ax/img/meta_opensource_logo_negative.svg" alt="Ax" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright © 2024 Meta Platforms, Inc.</div></div></div></footer></div>
</body>
</html>